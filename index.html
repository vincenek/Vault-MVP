<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vault - Financial Operating System</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.plaid.com/link/v2/stable/link-initialize.js"></script>
    <link href="https://api.fontshare.com/v2/css?f[]=satoshi@700,500,400&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #101828;
            --accent: #3B82F6;
            --dark: #1D2939;
            --light: #F8FAFC;
            --success: #22C55E;
        }

        body {
            font-family: 'Satoshi', sans-serif;
            background: var(--light);
            color: var(--primary);
            line-height: 1.6;
            max-width: 1440px;
            margin: 0 auto;
            padding: 2rem;
        }

        .header {
            text-align: center;
            padding: 3rem 0;
            border-bottom: 1px solid #EAECF0;
            margin-bottom: 3rem;
        }

        .header img {
            height: 80px;
            margin-bottom: 1.5rem;
            transition: transform 0.3s ease;
        }

        .header img:hover {
            transform: rotate(-5deg);
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .card {
            background: white;
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 1px 3px rgba(16, 24, 40, 0.1);
            border: 1px solid #F2F4F7;
            transition: transform 0.2s ease;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        input {
            width: 100%;
            padding: 0.875rem;
            margin: 0.75rem 0;
            border: 1px solid #D0D5DD;
            border-radius: 0.5rem;
            font-size: 1rem;
        }

        button {
            background: var(--accent);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 0.5rem;
            cursor: pointer;
            font-weight: 500;
            width: 100%;
            margin-top: 1rem;
            transition: opacity 0.2s;
        }

        button:disabled {
            background: #94A3B8;
            cursor: not-allowed;
        }

        .loader {
            display: none;
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--accent);
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        #dashboard {
            background: white;
            padding: 2rem;
            border-radius: 1rem;
            margin-top: 2rem;
        }

        .data-summary {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .summary-item {
            text-align: center;
            padding: 1.5rem;
            background: var(--light);
            border-radius: 0.75rem;
            border: 1px solid #EAECF0;
        }

        .api-badge {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            background: var(--dark);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 2rem;
            font-size: 0.875rem;
        }
    </style>
</head>
<body>
    <div class="header">
        <img src="https://i.postimg.cc/y39PyW30/IMG-0608.jpg" alt="Vault Logo">
        <h1>Your Enterprise Financial OS</h1>
    </div>

    <div class="grid">
        <!-- Tax Calculator -->
        <div class="card">
            <h2>ðŸ“ˆ Advanced Tax Engine</h2>
            <input type="number" id="income" placeholder="Annual Income ($)">
            <input type="number" id="expenses" placeholder="Deductible Expenses ($)">
            <div class="loader" id="taxLoader"></div>
            <button onclick="calculateTax()" id="taxButton">
                Optimize Tax Strategy
            </button>
            <div id="taxResult" class="summary-item" style="display:none;"></div>
        </div>

        <!-- Payroll System -->
        <div class="card">
            <h2>ðŸ‘¥ Intelligent Payroll</h2>
            <input type="number" id="hours" placeholder="Monthly Hours">
            <input type="number" id="rate" placeholder="Hourly Rate ($)">
            <div class="loader" id="payrollLoader"></div>
            <button onclick="calculatePayroll()" id="payrollButton">
                Process Payroll
            </button>
            <div id="payrollResult" class="summary-item" style="display:none;"></div>
        </div>

        <!-- Depreciation Manager -->
        <div class="card">
            <h2>ðŸ“‰ Asset Optimizer</h2>
            <input type="number" id="assetValue" placeholder="Asset Value ($)">
            <input type="number" id="assetLife" placeholder="Useful Life (years)">
            <div class="loader" id="depreciationLoader"></div>
            <button onclick="calculateDepreciation()" id="depreciationButton">
                Calculate Depreciation
            </button>
            <div id="depreciationResult" class="summary-item" style="display:none;"></div>
        </div>
    </div>

    <!-- Financial Command Center -->
    <div id="dashboard">
        <h2>ðŸ“Š Executive Dashboard</h2>
        <div class="data-summary">
            <div class="summary-item">
                <h3>Total Tax Liability</h3>
                <p id="totalTax">$0</p>
            </div>
            <div class="summary-item">
                <h3>Total Payroll</h3>
                <p id="totalPayroll">$0</p>
            </div>
            <div class="summary-item">
                <h3>Managed Assets</h3>
                <p id="totalAssets">$0</p>
            </div>
        </div>
        <canvas id="financialChart"></canvas>
    </div>

    <div class="api-badge">
        Powered by: TaxAPI.io | Plaid | Chart.js
    </div>

    <script>
        // API Endpoints (Replace with your keys)
        const TAX_API = 'https://api.taxapi.io/v1/calculate?api_key=YOUR_KEY';
        const PLAID_API = 'https://cdn.plaid.com/link/v2/stable/link-initialize.js';

        let financialState = {
            tax: 0,
            payroll: 0,
            assets: [],
            transactions: []
        };

        // Professional Error Handler
        class FinancialError extends Error {
            constructor(message, type) {
                super(message);
                this.name = "FinancialError";
                this.type = type;
            }
        }

        async function calculateTax() {
            try {
                toggleLoader('tax', true);
                
                const income = parseFloat(document.getElementById('income').value);
                const expenses = parseFloat(document.getElementById('expenses').value);

                if (!income || income < 0) throw new FinancialError('Invalid income value', 'validation');
                if (expenses < 0) throw new FinancialError('Expenses cannot be negative', 'validation');

                // Simulate API call
                const response = await mockTaxAPI(income, expenses);
                
                financialState.tax = response.taxOwed;
                displayResult('taxResult', 
                    `Optimized Tax: $${response.taxOwed.toFixed(2)}`,
                    `Potential Savings: $${response.savings.toFixed(2)}`
                );
                
                updateDashboard();
            } catch (error) {
                handleError(error, 'tax');
            } finally {
                toggleLoader('tax', false);
            }
        }

        async function calculatePayroll() {
            try {
                toggleLoader('payroll', true);
                
                const hours = parseFloat(document.getElementById('hours').value);
                const rate = parseFloat(document.getElementById('rate').value);

                if (!hours || hours < 0) throw new FinancialError('Invalid hours', 'validation');
                if (!rate || rate < 0) throw new FinancialError('Invalid rate', 'validation');

                // Simulate payroll processing
                const payroll = await processPayroll(hours, rate);
                
                financialState.payroll = payroll.netPay;
                displayResult('payrollResult',
                    `Net Pay: $${payroll.netPay.toFixed(2)}`,
                    `Gross: $${payroll.grossPay.toFixed(2)}`
                );
                
                updateDashboard();
            } catch (error) {
                handleError(error, 'payroll');
            } finally {
                toggleLoader('payroll', false);
            }
        }

        // Advanced Business Logic
        async function mockTaxAPI(income, expenses) {
            return new Promise(resolve => setTimeout(() => {
                const taxBrackets = [
                    { min: 0, max: 9950, rate: 0.10 },
                    { min: 9951, max: 40525, rate: 0.12 },
                    { min: 40526, max: 86375, rate: 0.22 },
                    { min: 86376, max: 164925, rate: 0.24 },
                    { min: 164926, max: 209425, rate: 0.32 },
                    { min: 209426, max: 523600, rate: 0.35 },
                    { min: 523601, rate: 0.37 }
                ];

                let taxableIncome = income - expenses;
                let taxOwed = 0;

                for (const bracket of taxBrackets) {
                    if (taxableIncome <= 0) break;
                    const bracketRange = bracket.max ? 
                        Math.min(bracket.max - bracket.min, taxableIncome) : 
                        taxableIncome;
                    taxOwed += bracketRange * bracket.rate;
                    taxableIncome -= bracketRange;
                }

                resolve({
                    taxOwed,
                    savings: (income * 0.25) - taxOwed // Simulated optimization
                });
            }, 1500));
        }

        // Professional Helper Functions
        function toggleLoader(type, state) {
            document.getElementById(`${type}Loader`).style.display = state ? 'block' : 'none';
            document.getElementById(`${type}Button`).disabled = state;
        }

        function displayResult(containerId, ...lines) {
            const container = document.getElementById(containerId);
            container.innerHTML = lines.map(line => `<p>${line}</p>`).join('');
            container.style.display = 'block';
        }

        function handleError(error, type) {
            console.error(`[${type.toUpperCase()}]`, error);
            alert(`Financial Error: ${error.message}`);
        }

        // Initialize Dashboard
        let financialChart;
        function updateDashboard() {
            document.getElementById('totalTax').textContent = `$${financialState.tax.toFixed(2)}`;
            document.getElementById('totalPayroll').textContent = `$${financialState.payroll.toFixed(2)}`;
            document.getElementById('totalAssets').textContent = `$${financialState.assets.reduce((a,b) => a + b.value, 0).toFixed(2)}`;

            const ctx = document.getElementById('financialChart').getContext('2d');
            if (financialChart) financialChart.destroy();

            financialChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Tax', 'Payroll', 'Assets'],
                    datasets: [{
                        data: [
                            financialState.tax,
                            financialState.payroll,
                            financialState.assets.reduce((a,b) => a + b.value, 0)
                        ],
                        backgroundColor: [
                            '#3B82F6',
                            '#10B981',
                            '#6366F1'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { position: 'right' },
                        tooltip: { enabled: false }
                    }
                }
            });
        }
    </script>
</body>
</html>
